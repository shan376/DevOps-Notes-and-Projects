âœ… AWS Monitoring & Alarming (Full Practical with IAM, KMS, EC2, CloudTrail, CloudWatch, SNS)

________________________________________
ğŸ§  Practical Work 
________________________________________

ğŸ”¹ Step 1: IAM User Banana (Admin Access)
AWS Console â†’ IAM â†’ Add User â†’ naam do (kms-admin)
â†’ Console access enable â†’ AdministratorAccess policy attach karo
â†’ User create karo aur Access key/Secret key save kar lo.
ğŸ‘‰ Purpose: ye user sab AWS services (KMS, CloudTrail etc.) manage karega.

ğŸ”¹ Step 2: KMS Key Banana (Encryption ke liye)
KMS â†’ Customer Managed Keys â†’ Create Key â†’ Symmetric select karo
â†’ Alias: alias/cloudtrail-logs-key â†’ apna IAM user (kms-admin) add karo
â†’ Policy me CloudTrail permission zaroor daalni hai (warna error aayega)
â†’ Review â†’ Create Key
ğŸ‘‰ Purpose: CloudTrail ke logs encrypt karne ke liye.

ğŸ”¹ Step 3: EC2 Instance Launch Karna
EC2 â†’ Launch Instance â†’ Amazon Linux 2 â†’ t2.micro
â†’ SSH (22) allow karo â†’ Key pair banao â†’ Launch karo
ğŸ‘‰ Purpose: ye instance hum monitoring aur alerting test ke liye use karenge.

ğŸ”¹ Step 4: CloudTrail Enable Karna (KMS Key ke saath)
CloudTrail â†’ Create Trail â†’ Apply to all regions
â†’ New S3 bucket banao (unique name dena)
â†’ SSE-KMS Encryption enable karo â†’ apni alias/cloudtrail-logs-key select karo
â†’ Log validation enable â†’ Create Trail
ğŸ‘‰ Purpose: account ke andar hone wali har activity ka secure audit log banana.

ğŸ”¹ Step 5: CloudWatch Dashboard Banana
CloudWatch â†’ Dashboards â†’ Create Dashboard
â†’ Widget: Line Graph â†’ Metric: EC2 â†’ CPUUtilization
â†’ Apna instance select karo â†’ Save Dashboard
ğŸ‘‰ Purpose: real-time CPU aur performance monitoring ke liye dashboard.

ğŸ”¹ Step 6: SNS Topic & Email Subscription
SNS â†’ Create Topic (name: CPU-Alerts)
â†’ Create Subscription â†’ Protocol: Email â†’ Endpoint: apni email
â†’ Email inbox me jaakar confirm karo.
ğŸ‘‰ Purpose: CPU alert trigger hone par email receive karna.

ğŸ”¹ Step 7: CloudWatch Alarm Create Karna (CPU > 70%)
CloudWatch â†’ Alarms â†’ Create Alarm
â†’ Metric: EC2 â†’ CPUUtilization â†’ Apna instance select karo
â†’ Threshold: 70% se zyada â†’ Action: Notify CPU-Alerts
â†’ Name: High-CPU-Usage â†’ Create Alarm
ğŸ‘‰ Purpose: jab CPU usage high ho to automatic email alert aaye.

ğŸ”¹ Step 8: CPU Load Generate Karna aur Alarm Test
SSH se EC2 join karo:
```bash
ssh -i key.pem ubuntu@<EC2-IP>
sudo apt update -y
sudo apt install stress-ng -y
stress-ng --cpu 4 --timeout 300s
stress-ng --cpu 2 --cpu-load 95 --timeout 600s
````

CloudWatch me jao â†’ Alarm state dekho (ALARM â†’ OK)
Email inbox check karo â†’ Alerts receive hone chahiye.
ğŸ‘‰ Purpose: real test karna ke alert system sahi kaam kar raha hai ya nahi.

ğŸ”¹ Step 9: CloudTrail Logs Verify Karna
CloudTrail â†’ Event History â†’ Filter: ec2.amazonaws.com
â†’ Instance start/stop/terminate logs check karo.
ğŸ‘‰ Purpose: verify karna ke CloudTrail sahi tarah sab events record kar raha hai.

---

ğŸ“Š Summary Table

| Task                 | Status | Notes                       |
| -------------------- | ------ | --------------------------- |
| IAM User             | âœ…      | kms-admin created           |
| KMS Key              | âœ…      | alias/cloudtrail-logs-key   |
| EC2 Instance         | âœ…      | t2.micro launched           |
| CloudTrail           | âœ…      | Logs encrypted              |
| CloudWatch Dashboard | âœ…      | CPUUtilization metric added |
| SNS Topic            | âœ…      | Email subscribed            |
| CloudWatch Alarm     | âœ…      | CPU > 70% alert created     |
| Stress Test          | âœ…      | Alarm + Email verified      |

---

ğŸ¯ Assignment: CPU Spike Notification Setup

Goal: Jab EC2 ka CPU usage 70% se zyada ho, AWS SNS ke zariye email alert bhejna.

1ï¸âƒ£ EC2 â†’ Launch Instance (Amazon Linux 2, t2.micro)
2ï¸âƒ£ SNS â†’ Create Topic (CPU-Alerts) â†’ Email subscribe & confirm
3ï¸âƒ£ CloudWatch â†’ Alarm â†’ Metric: CPUUtilization â†’ Threshold: >70% â†’ Notify: CPU-Alerts
4ï¸âƒ£ EC2 SSH â†’ Install stress-ng:

```bash
sudo apt update -y
sudo apt install stress-ng -y
stress-ng --cpu 2 --cpu-load 95 --timeout 600s
```

5ï¸âƒ£ CloudWatch me Alarm status dekho â†’ Email inbox me alert aayega (ALARM â†’ OK)
âœ… Assignment complete!

---

ğŸ‘¨â€ğŸ’» End Result:
Poora AWS monitoring setup ready hai â€” IAM, KMS, CloudTrail, CloudWatch, SNS sab integrated aur working!

```

---
